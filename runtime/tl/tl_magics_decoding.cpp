// Compiler for PHP (aka KPHP)
// Copyright (c) 2023 LLC «V Kontakte»
// Distributed under the GPL v3 License, see LICENSE.notice.txt

#include "runtime/tl/tl_magics_decoding.h"

// These functions are weak, because the definition is generated by KPHP compiler only if TL scheme is passed
const char * __attribute__ ((weak)) tl_function_magic_to_name_impl(uint32_t) noexcept;
array<int64_t> __attribute__ ((weak)) tl_magic_get_all_functions_impl();

const char *tl_function_magic_to_name(uint32_t magic) noexcept {
  if (!tl_function_magic_to_name_impl) {
    return "__unknown__";
  }
  return tl_function_magic_to_name_impl(static_cast<uint32_t>(magic));
}

array<int64_t> tl_magic_get_all_functions() noexcept {
  if (!tl_magic_get_all_functions_impl) {
    return {};
  }
  return tl_magic_get_all_functions_impl();
}

string f$convert_tl_function_magic_to_name(int64_t magic) noexcept {
  return string{tl_function_magic_to_name(static_cast<uint32_t>(magic))};
}

array<int64_t> f$get_all_tl_function_magics() noexcept {
  return tl_magic_get_all_functions();
}
